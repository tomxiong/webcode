<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Users - CLSI Platform</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#2563eb">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="CLSI Platform">
    
    <!-- Styles -->
    <link rel="stylesheet" href="/css/mobile-base.css">
    <link rel="stylesheet" href="/css/users-mobile.css">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
</head>
<body>
    <!-- Header -->
    <header class="mobile-header">
        <div class="header-content">
            <h1 class="header-title">
                <svg class="header-icon" viewBox="0 0 24 24" width="24" height="24">
                    <path fill="currentColor" d="M16 4c0-1.11.89-2 2-2s2 .89 2 2-.89 2-2 2-2-.89-2-2M4 18v-6h3v-2c0-1.1.9-2 2-2h3.5c1.1 0 2 .9 2 2v2H18v6H4Z"/>
                </svg>
                Users
            </h1>
            <div class="header-actions">
                <button class="header-btn" id="searchToggle" aria-label="Search">
                    <svg viewBox="0 0 24 24" width="20" height="20">
                        <path fill="currentColor" d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/>
                    </svg>
                </button>
                <button class="header-btn" id="filterToggle" aria-label="Filter">
                    <svg viewBox="0 0 24 24" width="20" height="20">
                        <path fill="currentColor" d="M14 12v7.88c.04.3-.06.62-.29.83a.996.996 0 0 1-1.41 0l-2.01-2.01a.989.989 0 0 1-.29-.83V12H2l9.5-10L21 12h-7Z"/>
                    </svg>
                </button>
            </div>
        </div>
        
        <!-- Search Bar -->
        <div class="search-container" id="searchContainer">
            <div class="search-input-wrapper">
                <svg class="search-icon" viewBox="0 0 24 24" width="20" height="20">
                    <path fill="currentColor" d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/>
                </svg>
                <input type="text" id="searchInput" placeholder="Search users..." class="search-input">
                <button class="search-clear" id="searchClear" aria-label="Clear search">
                    <svg viewBox="0 0 24 24" width="16" height="16">
                        <path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <!-- Filter Chips -->
    <div class="filter-section" id="filterSection">
        <div class="filter-chips">
            <button class="filter-chip active" data-filter="all">
                <span>All Users</span>
                <span class="chip-count" id="allCount">0</span>
            </button>
            <button class="filter-chip" data-filter="ADMIN">
                <span>Admins</span>
                <span class="chip-count" id="adminCount">0</span>
            </button>
            <button class="filter-chip" data-filter="LAB_TECH">
                <span>Lab Techs</span>
                <span class="chip-count" id="labTechCount">0</span>
            </button>
            <button class="filter-chip" data-filter="VIEWER">
                <span>Viewers</span>
                <span class="chip-count" id="viewerCount">0</span>
            </button>
            <button class="filter-chip" data-filter="active">
                <span>Active</span>
                <span class="chip-count" id="activeCount">0</span>
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Loading State -->
        <div class="loading-container" id="loadingContainer">
            <div class="loading-spinner"></div>
            <p class="loading-text">Loading users...</p>
        </div>

        <!-- Users List -->
        <div class="users-container" id="usersContainer">
            <div class="users-list" id="usersList">
                <!-- Users will be dynamically loaded here -->
            </div>
            
            <!-- Load More Button -->
            <button class="load-more-btn" id="loadMoreBtn" style="display: none;">
                <svg viewBox="0 0 24 24" width="20" height="20">
                    <path fill="currentColor" d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8-8-8z"/>
                </svg>
                Load More Users
            </button>
        </div>

        <!-- Empty State -->
        <div class="empty-state" id="emptyState" style="display: none;">
            <svg class="empty-icon" viewBox="0 0 24 24" width="64" height="64">
                <path fill="currentColor" d="M16 4c0-1.11.89-2 2-2s2 .89 2 2-.89 2-2 2-2-.89-2-2M4 18v-6h3v-2c0-1.1.9-2 2-2h3.5c1.1 0 2 .9 2 2v2H18v6H4Z"/>
            </svg>
            <h3 class="empty-title">No Users Found</h3>
            <p class="empty-description">Try adjusting your search or filter criteria.</p>
            <button class="btn btn-primary" id="clearFiltersBtn">Clear Filters</button>
        </div>
    </main>

    <!-- Floating Action Button -->
    <button class="fab" id="addUserFab" aria-label="Add User">
        <svg viewBox="0 0 24 24" width="24" height="24">
            <path fill="currentColor" d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
        </svg>
    </button>

    <!-- Bottom Sheet -->
    <div class="bottom-sheet-overlay" id="bottomSheetOverlay">
        <div class="bottom-sheet" id="bottomSheet">
            <div class="bottom-sheet-header">
                <div class="bottom-sheet-handle"></div>
                <h3 class="bottom-sheet-title" id="bottomSheetTitle">User Details</h3>
                <button class="bottom-sheet-close" id="closeBottomSheet" aria-label="Close">
                    <svg viewBox="0 0 24 24" width="20" height="20">
                        <path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
            </div>
            <div class="bottom-sheet-content" id="bottomSheetContent">
                <!-- Content will be dynamically loaded -->
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Scripts -->
    <script src="/js/mobile-base.js"></script>
    <script src="/js/mobile-navigation.js"></script>
    <script src="/js/users-mobile.js"></script>
    <script src="/js/mobile-navigation.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js');
        }
    </script>
</body>
</html>